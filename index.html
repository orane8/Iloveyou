  <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>For Deagerjohne (Mami) üíñ</title>

<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600;700&family=Special+Elite&display=swap" rel="stylesheet">

<style>
*{ margin:0; padding:0; box-sizing:border-box; }

:root{
  --pink:#ff3366;
  --pink2:#ff99cc;
  --paper:#fffaf0;

  --padX: clamp(16px, 4vw, 50px);
  --padY: clamp(18px, 5vw, 50px);
  --title: clamp(2.05rem, 6vw, 2.6rem);
  --qSize: clamp(1.45rem, 5vw, 1.7rem);
  --body: clamp(1.02rem, 3.6vw, 1.1rem);
}

body{
  min-height:100vh;
  background: linear-gradient(135deg, #ffd1dc, #ffe6f0);
  font-family:'Special Elite', cursive;
  overflow-x:hidden;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding: max(18px, env(safe-area-inset-top)) max(14px, env(safe-area-inset-right)) 30px max(14px, env(safe-area-inset-left));
  position:relative;
  transition: background 1.2s ease, color 1.2s ease;
}

body.night{
  background: radial-gradient(circle at top, #1a1a2e, #0f0f1a 70%);
  color:white;
}

/* Background floating hearts container */
.floating-hearts{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:0;
  overflow:hidden;
}

/* Soft floating emoji hearts */
.bg-heart{
  position:absolute;
  opacity:0.22;
  filter: blur(0.2px);
  animation:bgFloat linear infinite;
  will-change: transform, opacity;
  transform: translate3d(0,0,0);
}

@keyframes bgFloat{
  0%   { transform: translate3d(0, 110vh, 0) scale(1); opacity:0; }
  15%  { opacity:0.25; }
  50%  { transform: translate3d(30px, 50vh, 0) scale(1.12); }
  100% { transform: translate3d(-30px, -15vh, 0) scale(1.20); opacity:0; }
}

/* Stars */
.star{
  position:fixed;
  border-radius:50%;
  background:white;
  opacity:0;
  animation:twinkle infinite alternate;
  z-index:1;
  will-change: opacity;
}
@keyframes twinkle{
  from{opacity:0.12;}
  to{opacity:1;}
}

/* Classic floating pink hearts (shape hearts) */
.heart{
  position:fixed;
  width:18px;
  height:18px;
  background:#ff4d6d;
  transform: rotate(45deg) translate3d(0,0,0);
  animation: floatUp 8s linear infinite;
  opacity:0.55;
  z-index:0;
  will-change: transform, opacity;
}
.heart::before,
.heart::after{
  content:'';
  position:absolute;
  width:18px;
  height:18px;
  background:#ff4d6d;
  border-radius:50%;
}
.heart::before{ top:-9px; left:0; }
.heart::after{ left:-9px; top:0; }

@keyframes floatUp{
  0%   { transform: translate3d(0,110vh,0) rotate(45deg); opacity:0; }
  20%  { opacity:0.65; }
  100% { transform: translate3d(0,-15vh,0) rotate(45deg); opacity:0; }
}

/* Letter */
.letter{
  background: var(--paper);
  padding: var(--padY) var(--padX);
  width:100%;
  max-width: 780px;
  border-radius:20px;
  box-shadow: 0 20px 50px rgba(0,0,0,0.3);
  text-align:center;
  position:relative;
  z-index:2;
  transition: background 1.2s ease, color 1.2s ease, box-shadow 1.2s ease;
}

body.night .letter{
  background: rgba(255,255,255,0.08);
  color:white;
  box-shadow: 0 0 60px rgba(255,105,180,0.35);
}

h1{
  font-family:'Dancing Script', cursive;
  font-size: var(--title);
  color: var(--pink);
  margin-bottom: 18px;
  transition: color 1.2s ease;
  line-height: 1.05;
}
body.night h1{ color: var(--pink2); }

.content{
  font-size: var(--body);
  line-height: 1.9;
  min-height: 200px;
  white-space: pre-line;
  word-break: break-word;
  overflow-wrap: anywhere;
}

.question{
  margin-top: 34px;
  font-family:'Dancing Script', cursive;
  font-size: var(--qSize);
  transition: opacity .6s ease, transform .6s ease;
}
.question.answered{
  opacity:0.55;
  transform: translateY(-4px);
}

.answer-area{
  margin-top: 14px;
  min-height: 150px;
  display:grid;
  place-items:center;
  gap: 12px;
}

.buttons{
  position:relative;
  min-height: 70px;
  display:flex;
  flex-wrap: wrap;
  justify-content:center;
  align-items:center;
  gap: 10px;
}

/* iPhone-friendly buttons */
button{
  padding: 12px 22px;
  font-size: 1rem;
  border:none;
  border-radius: 999px;
  cursor:pointer;
  margin: 10px;
  transition: transform .25s ease, opacity .25s ease;
  user-select:none;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}
#yesBtn{ background: var(--pink); color:white; }
#yesBtn:disabled{ opacity:.85; cursor: default; }

#noBtn{
  background:#aaa;
  color:white;
  position:relative;
  will-change: transform;
}

/* Answer Card */
.answer-card{
  width:min(520px, 92%);
  background: rgba(255,255,255,0.92);
  border-radius: 18px;
  padding: 18px 18px 16px;
  box-shadow: 0 16px 35px rgba(0,0,0,0.18);
  border: 2px solid rgba(255, 51, 102, 0.25);
  display:none;
  position:relative;
  overflow:hidden;
  transform: translateY(10px);
  opacity:0;
  transition: transform .6s ease, opacity .6s ease, background 1s ease;
}
body.night .answer-card{
  background: rgba(255,255,255,0.08);
  border-color: rgba(255,153,204,0.25);
}
.answer-card.show{
  display:block;
  opacity:1;
  transform: translateY(0);
}

.answer-title{
  font-family:'Dancing Script', cursive;
  font-size: clamp(1.6rem, 5vw, 1.9rem);
  color: var(--pink);
}
body.night .answer-title{ color: var(--pink2); }

.answer-text{
  margin-top: 6px;
  font-size: 1.03rem;
  opacity: .95;
}
.answer-footer{
  margin-top: 10px;
  font-family:'Dancing Script', cursive;
  font-size: 1.2rem;
  color: var(--pink);
}
body.night .answer-footer{ color: var(--pink2); }

/* Stamp */
.stamp{
  position:absolute;
  right: 14px;
  top: 14px;
  transform: rotate(-14deg) scale(0.6);
  transform-origin:center;
  padding: 10px 14px;
  border: 3px dashed rgba(255, 51, 102, 0.75);
  border-radius: 12px;
  color: rgba(255, 51, 102, 0.9);
  font-family:'Special Elite', cursive;
  letter-spacing: 2px;
  font-size: 1.02rem;
  background: rgba(255,255,255,0.6);
  opacity:0;
}
body.night .stamp{
  border-color: rgba(255,153,204,0.8);
  color: rgba(255,153,204,0.95);
  background: rgba(0,0,0,0.25);
}
.stamp.stamp-in{
  animation: stampBounce 650ms cubic-bezier(.17,.89,.32,1.49) forwards;
}
@keyframes stampBounce{
  0%   { opacity:0; transform: rotate(-14deg) scale(2.4); filter: blur(1px); }
  55%  { opacity:1; transform: rotate(-14deg) scale(0.95); filter: blur(0); }
  72%  { opacity:1; transform: rotate(-14deg) scale(1.10); }
  86%  { opacity:1; transform: rotate(-14deg) scale(0.98); }
  100% { opacity:1; transform: rotate(-14deg) scale(1); }
}

/* Pop hearts from YES */
.pop-heart{
  position:fixed;
  z-index:999;
  pointer-events:none;
  animation: pop 900ms cubic-bezier(.17,.89,.32,1.49) forwards;
  will-change: transform, opacity;
  transform: translate3d(0,0,0);
}
@keyframes pop{
  0%   { transform: translate3d(0,0,0) scale(0.9); opacity:1; }
  100% { transform: translate3d(var(--dx), var(--dy), 0) scale(1.8); opacity:0; }
}

/* Confetti */
.confetti-heart{
  position:fixed;
  z-index:999;
  pointer-events:none;
  animation: confettiFall linear forwards;
  will-change: transform, opacity;
  transform: translate3d(0,0,0);
}
@keyframes confettiFall{
  0%   { transform: translate3d(0,-10vh,0) rotate(0deg); opacity:1; }
  100% { transform: translate3d(0,110vh,0) rotate(360deg); opacity:0; }
}

/* Explosion */
.explosion-heart{
  position:fixed;
  z-index:999;
  pointer-events:none;
  animation: explode 1s ease-out forwards;
  will-change: transform, opacity;
  transform: translate3d(0,0,0);
}
@keyframes explode{
  to{ transform: translate3d(var(--x), var(--y), 0) scale(2); opacity:0; }
}

/* Extra small screens */
@media (max-width: 380px){
  .letter{ border-radius: 16px; }
  .content{ line-height: 1.85; }
  button{ width: min(220px, 90%); }
  .buttons{ flex-direction: column; }
  .stamp{ right: 10px; top: 10px; }
}
</style>
</head>

<body>

<div class="floating-hearts" id="floatingHearts"></div>

<audio id="bgMusic" loop>
  <source src="https://www.bensound.com/bensound-music/bensound-romantic.mp3" type="audio/mp3">
</audio>

<div class="letter">
  <h1>My Dearest Deagerjohne (Mami) üíï</h1>
  <div class="content" id="letterText"></div>

  <div class="question" id="questionText">Do you love me? üíñ</div>

  <div class="answer-area">
    <div class="buttons" id="buttonWrap">
      <button id="yesBtn">Yes ‚ù§Ô∏è</button>
      <button id="noBtn">No üôà</button>
    </div>

    <div class="answer-card" id="answerCard">
      <div class="stamp" id="stamp">MINE üíó</div>
      <div class="answer-title">She chose: YES ‚ù§Ô∏è</div>
      <div class="answer-text">I knew you‚Äôd say yes‚Ä¶ as always üíñ</div>
      <div class="answer-footer">‚Äî Orane üíå</div>
    </div>
  </div>
</div>

<script>
/* ---------- Typewriter ---------- */
const text = `My beautiful Deagerjohne, my sweet Mami,

From the very first moment you stepped into my life, something changed inside me.
You became my warmth, my peace, and my greatest happiness.

Mami, you are the smile I look for every morning and the thought I carry every night.
Your laughter makes my world brighter, and your love makes me stronger.

You make ordinary days feel special.
You make hard days feel lighter.
You make my life feel more complete just by being in it.

I promise to cherish you, protect your heart, and stand beside you through every season of life.
You are not just someone I love ‚Äî you are my person, my always, my comfort.

With all my heart,
Orane üíå`;

let twIndex = 0;
function typeWriter(){
  const el = document.getElementById("letterText");
  if (twIndex < text.length){
    el.innerHTML += text.charAt(twIndex);
    twIndex++;
    setTimeout(typeWriter, 30);
  }
}
typeWriter();

/* ---------- Mobile performance tuning ---------- */
const isSmallScreen = window.matchMedia("(max-width: 430px)").matches;
const BG_HEART_INTERVAL = isSmallScreen ? 1400 : 1100;
const SHAPE_HEART_INTERVAL = isSmallScreen ? 700 : 550;
const STAR_COUNT = isSmallScreen ? 220 : 340;
const CONFETTI_COUNT = isSmallScreen ? 90 : 140;
const EXPLODE_COUNT = isSmallScreen ? 28 : 46;
const POP_COUNT = isSmallScreen ? 18 : 26;

/* ---------- Background floating emoji hearts ---------- */
const floatingHearts = document.getElementById("floatingHearts");
setInterval(() => {
  const h = document.createElement("div");
  h.className = "bg-heart";
  h.textContent = Math.random() > 0.5 ? "üíó" : "üíû";
  h.style.left = (Math.random() * 100) + "vw";
  h.style.fontSize = (Math.random() * 22 + 14) + "px";
  h.style.animationDuration = (Math.random() * 12 + 14) + "s";
  floatingHearts.appendChild(h);
  setTimeout(() => h.remove(), 28000);
}, BG_HEART_INTERVAL);

/* ---------- Floating shape hearts ---------- */
setInterval(() => {
  const heart = document.createElement("div");
  heart.classList.add("heart");
  heart.style.left = (Math.random() * 100) + "vw";
  heart.style.opacity = (Math.random() * 0.35 + 0.25).toFixed(2);
  heart.style.animationDuration = (Math.random() * 4 + 7) + "s";
  document.body.appendChild(heart);
  setTimeout(() => heart.remove(), 12000);
}, SHAPE_HEART_INTERVAL);

/* ---------- No runs away + Yes grows (bounded movement) ---------- */
const noBtn = document.getElementById("noBtn");
const yesBtn = document.getElementById("yesBtn");
const buttonWrap = document.getElementById("buttonWrap");

let yesScale = 1;
let noResetTimer = null;

function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

noBtn.addEventListener("mouseover", () => {
  const dx = clamp(Math.random()*220 - 110, -90, 90);
  const dy = clamp(Math.random()*120 - 60, -45, 45);

  noBtn.style.transform = `translate(${dx}px, ${dy}px)`;

  yesScale = Math.min(yesScale + 0.08, 2.1);
  yesBtn.style.transform = `scale(${yesScale})`;

  if (noResetTimer) clearTimeout(noResetTimer);
  noResetTimer = setTimeout(() => {
    noBtn.style.transform = "translate(0, 0)";
  }, 650);
});

/* ---------- Performance batching ---------- */
function spawnInBatches(total, batchSize, makeOne){
  let made = 0;
  function step(){
    const frag = document.createDocumentFragment();
    const count = Math.min(batchSize, total - made);
    for (let i=0;i<count;i++) frag.appendChild(makeOne());
    document.body.appendChild(frag);
    made += count;
    if (made < total) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

/* Stars */
let starsMade = false;
function createStarsBatched(count){
  if (starsMade) return;
  starsMade = true;
  spawnInBatches(count, 60, () => {
    const s = document.createElement("div");
    s.className = "star";
    const size = Math.random() * 2.8 + 0.8;
    s.style.width = size + "px";
    s.style.height = size + "px";
    s.style.top = (Math.random()*100) + "vh";
    s.style.left = (Math.random()*100) + "vw";
    s.style.animationDuration = (Math.random()*3.5 + 1.0) + "s";
    s.style.animationDelay = (Math.random()*3.5) + "s";
    return s;
  });
}

/* Confetti */
function confettiBatched(amount){
  spawnInBatches(amount, 30, () => {
    const c = document.createElement("div");
    c.className = "confetti-heart";
    c.textContent = Math.random() > 0.5 ? "‚ù§Ô∏è" : "üíñ";
    c.style.left = (Math.random()*100) + "vw";
    c.style.fontSize = (Math.random()*22 + 14) + "px";
    c.style.animationDuration = (Math.random()*2.2 + 3.0) + "s";
    setTimeout(() => c.remove(), 6500);
    return c;
  });
}

/* Explosion */
function explosionBatched(amount){
  spawnInBatches(amount, 18, () => {
    const e = document.createElement("div");
    e.className = "explosion-heart";
    e.textContent = "üíñ";
    e.style.left = "50%";
    e.style.top = "50%";
    e.style.setProperty("--x", (Math.random()*520 - 260) + "px");
    e.style.setProperty("--y", (Math.random()*520 - 260) + "px");
    setTimeout(() => e.remove(), 1100);
    return e;
  });
}

/* Pop hearts from Yes */
function popFromElementBatched(el, amount){
  const r = el.getBoundingClientRect();
  const ox = r.left + r.width/2;
  const oy = r.top + r.height/2;

  spawnInBatches(amount, 12, () => {
    const h = document.createElement("div");
    h.className = "pop-heart";
    h.textContent = Math.random() > 0.5 ? "üíñ" : "‚ù§Ô∏è";
    h.style.left = ox + "px";
    h.style.top = oy + "px";
    h.style.setProperty("--dx", (Math.random()*260 - 130) + "px");
    h.style.setProperty("--dy", (Math.random()*-240 - 40) + "px");
    h.style.fontSize = (Math.random()*14 + 16) + "px";
    setTimeout(() => h.remove(), 1000);
    return h;
  });
}

/* ---------- Music volume fix: start quiet + fade in ---------- */
function playMusicSoft(){
  const music = document.getElementById("bgMusic");
  if (!music) return;

  // start very quiet
  music.volume = 0.0;

  try {
    const p = music.play();
    if (p && typeof p.catch === "function") p.catch(() => {});
  } catch(e){}

  // fade to comfortable level
  const target = 0.16;   // final volume (adjust 0.12‚Äì0.20)
  const step = 0.012;    // fade speed
  const interval = 140;  // ms

  let v = 0;
  const fade = setInterval(() => {
    v = Math.min(target, v + step);
    music.volume = v;
    if (v >= target) clearInterval(fade);
  }, interval);
}

/* YES click */
let answered = false;
yesBtn.addEventListener("click", () => {
  if (answered) return;
  answered = true;
  yesBtn.disabled = true;

  // instant UI first
  document.body.classList.add("night");
  document.getElementById("questionText").classList.add("answered");
  buttonWrap.style.display = "none";

  const card = document.getElementById("answerCard");
  const stamp = document.getElementById("stamp");
  card.classList.add("show");
  stamp.classList.add("stamp-in");

  // play music softly (fixed)
  playMusicSoft();

  // effects next frame (no lag)
  requestAnimationFrame(() => {
    popFromElementBatched(yesBtn, POP_COUNT);
    createStarsBatched(STAR_COUNT);
    explosionBatched(EXPLODE_COUNT);
    confettiBatched(CONFETTI_COUNT);
  });
});
</script>

</body>
</html>
